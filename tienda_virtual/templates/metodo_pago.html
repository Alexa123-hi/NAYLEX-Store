{% extends 'base.html' %}
{% block title %}Pago{% endblock %}
{% block content %}
<div class="d-flex justify-content-center align-items-center min-vh-100">
  <div class="metodo-pago-card">
    <div class="metodo-pago-title">ğŸ‘†ğŸ¼Selecciona el mÃ©todo de pago</div>

    {% if mensaje_exito %}
      <div class="alert alert-success text-center" id="mensaje-flash">{{ mensaje_exito }}</div>
      <meta http-equiv="refresh" content="3; url={{ url_for('productos_bp.productos') }}">
    {% else %}
      <form method="POST" action="{{ url_for('compras_bp.pago') }}">
        <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
        <div class="mb-3">
          <label for="metodo" class="form-label">ğŸ“ MÃ©todo de pago:</label>
          <select class="form-select" id="metodo" name="metodo" required>
            <option value="">ğŸ‘‰ğŸ¼Seleccione un mÃ©todo</option>
            {% for metodo in metodos_pago %}<option value="{{ metodo.id_metodo }}">{{ metodo.nombre }}</option>{% endfor %}
          </select>
        </div>

        <div id="datos-tarjeta" class="hidden">
          <div class="mb-3">
            <label for="numero_tarjeta" class="form-label">ğŸ’³NÃºmero de tarjeta:</label>
            <input type="text" class="form-control" id="numero_tarjeta" name="numero_tarjeta" maxlength="16">
          </div>
          <div class="mb-3">
            <label for="nombre_tarjeta" class="form-label">ğŸ¦²Nombre en la tarjeta:</label>
            <input type="text" class="form-control" id="nombre_tarjeta" name="nombre_tarjeta">
          </div>
          <div class="mb-3">
            <label for="expira" class="form-label">ğŸ—“ï¸Fecha de expiraciÃ³n:</label>
            <input type="text" class="form-control" id="expira" name="expira" placeholder="MM/AA" pattern="^(0[1-9]|1[0-2])\/\d{2}$">
            <small class="form-text text-muted">Formato: MM/AA. Ejemplo: 07/26</small>
          </div>
          <div class="mb-3">
            <label for="cvv" class="form-label">ğŸ·ï¸CVV:</label>
            <input type="text" class="form-control" id="cvv" name="cvv" maxlength="4">
          </div>
        </div>

        <div id="datos-pse" class="hidden">
          <div class="mb-3">
            <label for="banco" class="form-label">ğŸ¦Banco:</label>
            <input type="text" class="form-control" id="banco" name="banco">
          </div>
          <div class="mb-3">
            <label for="titular_pse" class="form-label">ğŸ‘¨ğŸ¼â€ğŸ“Titular:</label>
            <input type="text" class="form-control" id="titular_pse" name="titular_pse">
          </div>
          <div class="mb-3">
            <label for="documento_pse" class="form-label">ğŸªªDocumento:</label>
            <input type="text" class="form-control" id="documento_pse" name="documento_pse">
          </div>
        </div>

        <div class="d-flex justify-content-center mt-4">
          <button type="submit" class="btn btn-success w-75">ğŸ‘ğŸ¼Confirmar y pagar</button>
        </div>
      </form>
    {% endif %}
  </div>
</div>
{% endblock %}
